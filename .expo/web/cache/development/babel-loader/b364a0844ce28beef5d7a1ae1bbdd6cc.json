{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/stinenorklitlonborg/Desktop/projekt/brugerinddragelse/components/Map.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useEffect, useState } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport firebase from 'firebase';\nimport { Card } from \"react-native-paper\";\nimport SignUpForm from \"./SignUpForm\";\nimport LoginForm from \"./LoginForm\";\nimport Constants from 'expo-constants';\nimport MapView, { Marker } from 'react-native-maps';\nimport * as Location from 'expo-location';\nimport { Accuracy } from \"expo-location\";\nimport { GooglePlacesAutocomplete } from 'react-native-google-places-autocomplete';\n\nfunction Map() {\n  var _this = this;\n\n  var _useState = useState({\n    loggedIn: false\n  }),\n      _useState2 = _slicedToArray(_useState, 2),\n      user = _useState2[0],\n      setUser = _useState2[1];\n\n  function onAuthStateChange(callback) {\n    return firebase.auth().onAuthStateChanged(function (user) {\n      if (user) {\n        callback({\n          loggedIn: true,\n          user: user\n        });\n      } else {\n        callback({\n          loggedIn: false\n        });\n      }\n    });\n  }\n\n  useEffect(function () {\n    var unsubscribe = onAuthStateChange(setUser);\n    return function () {\n      unsubscribe();\n    };\n  }, []);\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      hasLocationPermission = _useState4[0],\n      setlocationPermission = _useState4[1];\n\n  var _useState5 = useState(null),\n      _useState6 = _slicedToArray(_useState5, 2),\n      currentLocation1 = _useState6[0],\n      setCurrentLocation = _useState6[1];\n\n  var _useState7 = useState([]),\n      _useState8 = _slicedToArray(_useState7, 2),\n      userMarkerCoordinates = _useState8[0],\n      setUserMarkerCoordinates = _useState8[1];\n\n  var _useState9 = useState(null),\n      _useState10 = _slicedToArray(_useState9, 2),\n      selectedCoordinate = _useState10[0],\n      setSelectedCoordinate = _useState10[1];\n\n  var _useState11 = useState(null),\n      _useState12 = _slicedToArray(_useState11, 2),\n      selectedAddress = _useState12[0],\n      setSelectedAddress = _useState12[1];\n\n  var getLocationPermission = function getLocationPermission() {\n    return _regeneratorRuntime.async(function getLocationPermission$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(Location.requestForegroundPermissionsAsync().then(function (item) {\n              setlocationPermission(item.granted);\n            }));\n\n          case 2:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  useEffect(function () {\n    var response = getLocationPermission();\n  });\n\n  var updateLocation = function updateLocation() {\n    return _regeneratorRuntime.async(function updateLocation$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return _regeneratorRuntime.awrap(Location.getCurrentPositionAsync({\n              accuracy: Accuracy.Balanced\n            }).then(function (item) {\n              setCurrentLocation(item.coords);\n            }));\n\n          case 2:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var handleLongPress = function handleLongPress(event) {\n    var coordinate = event.nativeEvent.coordinate;\n    setUserMarkerCoordinates(function (oldArray) {\n      return [].concat(_toConsumableArray(oldArray), [coordinate]);\n    });\n  };\n\n  var handleSelectMarker = function handleSelectMarker(coordinate) {\n    return _regeneratorRuntime.async(function handleSelectMarker$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            setSelectedCoordinate(coordinate);\n            _context3.next = 3;\n            return _regeneratorRuntime.awrap(Location.reverseGeocodeAsync(coordinate).then(function (data) {\n              setSelectedAddress(data);\n            }));\n\n          case 3:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var closeInfoBox = function closeInfoBox() {\n    return setSelectedCoordinate(null) && setSelectedAddress(null);\n  };\n\n  var RenderCurrentLocation = function RenderCurrentLocation(props) {\n    if (props.hasLocationPermission === null) {\n      return null;\n    }\n\n    if (props.hasLocationPermission === false) {\n      return React.createElement(Text, {\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 20\n        }\n      }, \"No location access. Go to settings to change\");\n    }\n\n    return React.createElement(View, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 13\n      }\n    }, React.createElement(Button, {\n      style: true,\n      title: \"update location\",\n      onPress: updateLocation,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 17\n      }\n    }), currentLocation1 && React.createElement(Text, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 21\n      }\n    }, \"lat: \" + currentLocation1.latitude + \",\\nLong:\" + currentLocation1.longitude + \"\\nacc: \" + currentLocation1.accuracy));\n  };\n\n  if (!firebase.auth().currentUser) {\n    return React.createElement(ScrollView, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 13\n      }\n    }, React.createElement(Image, {\n      source: require(\"../assets/dk-madkort.jpeg\"),\n      style: styles.image,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 17\n      }\n    }), React.createElement(Card, {\n      style: {\n        padding: 20\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 17\n      }\n    }, React.createElement(SignUpForm, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 21\n      }\n    })), React.createElement(Card, {\n      style: {\n        padding: 20\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 17\n      }\n    }, React.createElement(LoginForm, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 21\n      }\n    })), React.createElement(Text, {\n      style: styles.paragraph2,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 17\n      }\n    }, \"Jeg h\\xE5ber virkelig dette kan hj\\xE6lpe bare en smule!\"));\n  } else {\n      return React.createElement(View, {\n        style: styles.container,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 13\n        }\n      }, React.createElement(GooglePlacesAutocomplete, {\n        placeholder: \"Search\",\n        miniLenght: 2,\n        autoFocus: false,\n        fetchDetails: true,\n        renderDescription: function renderDescription(row) {\n          return row.description;\n        },\n        onPress: function onPress(data) {\n          var details = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n          console.log(data, details);\n        },\n        getDefaultValue: function getDefaultValue() {\n          return '';\n        },\n        query: {\n          key: 'AIzaSyCc8mR9JJqFV35qcL7WXn8nBvFPNGZ101w',\n          language: 'en',\n          types: \"establishment\",\n          components: \"country:dk\",\n          radius: 20000,\n          location: {\n            latitude: 55.676098,\n            longitude: 12.568337\n          }\n        },\n        styles: {\n          container: {\n            flex: 0,\n            position: \"absolute\",\n            width: \"100%\",\n            zIndex: 1\n          },\n          listView: {\n            backgroundColor: \"grey\"\n          }\n        },\n        currentLocation: true,\n        currentLocationLabel: \"Current Location\",\n        nearbyPlacesAPI: \"GooglePlacesSearch\",\n        GoogleReverseGeocodingQuery: {},\n        GooglePlacesSearchQuery: {\n          rankby: 'distance',\n          type: 'restaurant'\n        },\n        GooglePlacesDetailsQuery: {\n          fields: 'formatted_address'\n        },\n        debounce: 200,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 17\n        }\n      }), React.createElement(RenderCurrentLocation, {\n        props: {\n          hasLocationPermission: hasLocationPermission,\n          currentLocation1: currentLocation1\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 21\n        }\n      }), React.createElement(MapView, {\n        provider: 'google',\n        initialRegion: {\n          latitude: 55.676098,\n          longitude: 12.568337,\n          latitudeDelta: 0.0922,\n          longitudeDelta: 0.0421\n        },\n        style: styles.map,\n        showsUserLocation: true,\n        onLongPress: handleLongPress,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 17\n        }\n      }, React.createElement(Marker, {\n        coordinate: {\n          latitude: 55.676195,\n          longitude: 12.569419\n        },\n        title: \"R\\xE5dhuspladsen\",\n        description: \"blablabal\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 21\n        }\n      }), React.createElement(Marker, {\n        coordinate: {\n          latitude: 55.673035,\n          longitude: 12.568756\n        },\n        title: \"Tivoli\",\n        description: \"blablabal\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 21\n        }\n      }), React.createElement(Marker, {\n        coordinate: {\n          latitude: 55.674082,\n          longitude: 12.598108\n        },\n        title: \"Christiania\",\n        description: \"blablabal\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 21\n        }\n      }), userMarkerCoordinates.map(function (coordinate, index) {\n        return React.createElement(Marker, {\n          coordinate: coordinate,\n          key: index.toString(),\n          onPress: function onPress() {\n            return handleSelectMarker(coordinate);\n          },\n          __self: _this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 264,\n            columnNumber: 25\n          }\n        });\n      })), selectedCoordinate && selectedAddress && React.createElement(View, {\n        style: styles.infoBox,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 21\n        }\n      }, React.createElement(Text, {\n        style: styles.infoText,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 25\n        }\n      }, selectedCoordinate.latitude, \", \", selectedCoordinate.longitude), React.createElement(Text, {\n        style: styles.infoText,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 280,\n          columnNumber: 25\n        }\n      }, \"name: \", selectedAddress[0].name, \"  region: \", selectedAddress[0].region), React.createElement(Button, {\n        title: \"close\",\n        onPress: closeInfoBox,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 25\n        }\n      })));\n    }\n}\n\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1\n  },\n  map: {\n    width: Dimensions.get(\"window\").width,\n    height: Dimensions.get(\"window\").height\n  },\n  infoBox: {\n    height: 200,\n    position: 'absolute',\n    bottom: 0,\n    left: 0,\n    right: 0,\n    backgroundColor: 'yellow',\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n  infoText: {\n    fontSize: 15\n  },\n  image: {\n    marginHorizontal: \"10%\",\n    marginTop: \"5%\",\n    marginBottom: \"5%\",\n    width: \"80%\",\n    height: \"25%\"\n  },\n  paragraph2: {\n    marginTop: '50%',\n    fontSize: 18,\n    fontWeight: 'bold',\n    textAlign: 'center'\n  }\n});\nexport default Map;","map":{"version":3,"sources":["/Users/stinenorklitlonborg/Desktop/projekt/brugerinddragelse/components/Map.js"],"names":["React","useEffect","useState","firebase","Card","SignUpForm","LoginForm","Constants","MapView","Marker","Location","Accuracy","GooglePlacesAutocomplete","Map","loggedIn","user","setUser","onAuthStateChange","callback","auth","onAuthStateChanged","unsubscribe","hasLocationPermission","setlocationPermission","currentLocation1","setCurrentLocation","userMarkerCoordinates","setUserMarkerCoordinates","selectedCoordinate","setSelectedCoordinate","selectedAddress","setSelectedAddress","getLocationPermission","requestForegroundPermissionsAsync","then","item","granted","response","updateLocation","getCurrentPositionAsync","accuracy","Balanced","coords","handleLongPress","event","coordinate","nativeEvent","oldArray","handleSelectMarker","reverseGeocodeAsync","data","closeInfoBox","RenderCurrentLocation","props","latitude","longitude","currentUser","require","styles","image","padding","paragraph2","container","row","description","details","console","log","key","language","types","components","radius","location","flex","position","width","zIndex","listView","backgroundColor","rankby","type","fields","latitudeDelta","longitudeDelta","map","index","toString","infoBox","infoText","name","region","StyleSheet","create","Dimensions","get","height","bottom","left","right","justifyContent","alignItems","fontSize","marginHorizontal","marginTop","marginBottom","fontWeight","textAlign"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from 'react';\nimport {View, Text, Button, StyleSheet, Image, SafeAreaView, ScrollView, Dimensions} from 'react-native';\nimport firebase from 'firebase';\nimport {Card} from \"react-native-paper\";\nimport SignUpForm from \"./SignUpForm\";\nimport LoginForm from \"./LoginForm\";\nimport Constants from 'expo-constants';\nimport MapView, {Marker} from 'react-native-maps';\nimport * as Location from 'expo-location';\nimport {Accuracy} from \"expo-location\";\nimport { GooglePlacesAutocomplete } from 'react-native-google-places-autocomplete';\n\n\n\n\nfunction Map () {\n\n    //Her oprettes bruger state variblen\n    const [user, setUser] = useState({loggedIn: false});\n\n    //onAuthstatechanged er en prædefineret metode, forsynet af firebase, som konstant observerer brugerens status (logget ind vs logget ud)\n    //Pba. brugerens status foretages et callback i form af setUSer metoden, som håndterer user-state variablens status.\n    function onAuthStateChange(callback) {\n        return firebase.auth().onAuthStateChanged(user => {\n            if (user) {\n                callback({loggedIn: true, user: user});\n            } else {\n                callback({loggedIn: false});\n            }\n        });\n    }\n\n    //Heri aktiverer vi vores listener i form af onAuthStateChanged, så vi dynamisk observerer om brugeren er aktiv eller ej.\n    useEffect(() => {\n        const unsubscribe = onAuthStateChange(setUser);\n        return () => {\n            unsubscribe();\n        };\n    }, []);\n\n    // -------------------------------------------------------------------------------------\n\n    //Her instantieres alle anvendte statevariabler\n    const [hasLocationPermission, setlocationPermission] = useState(false)\n    const [currentLocation1, setCurrentLocation] = useState(null)\n    const [userMarkerCoordinates, setUserMarkerCoordinates] = useState([])\n    const [selectedCoordinate, setSelectedCoordinate] = useState(null)\n    const [selectedAddress, setSelectedAddress] = useState(null)\n\n    /*\n    * getLocationPermission udnytter den prædefinerede asynkrone metode requestForegroundPermissionsAsync,\n    * som aktiverer en forespørgsel om tilladelse til at benytte enhedens position\n    * resultatet af denne handling leveres og benyttes til at sætte værdien af locationPermission\n    * Værdien sættes pba. af værdien item.granted\n    * Læs mere i dokumentationen:  https://docs.expo.dev/versions/latest/sdk/location/\n    */\n    const getLocationPermission = async () => {\n        await Location.requestForegroundPermissionsAsync().then((item)=>{\n            setlocationPermission(item.granted)\n        } );\n\n    };\n\n    // I useEffect kaldes getlocationPermission, der sikrer at enheden forespørger tilladelse\n    // så snart appen kører\n    useEffect (() => {\n        const response = getLocationPermission()\n    });\n\n    /*\n    * Metoden updateLocation udnytter det prædefinerede asynkrone kald, getCurrentPositionAsync, returnerer enhedens aktuelle position\n    * Resultatet fra kaldet benyttes til at fastsætte værdien af currentlokation.\n    * argumentet, Accuracy.Balanced, angiver den nøjagtighed vi ønsker skal bruges til at angive positionen.\n    * Læs mere på den førnævnte dokumentation\n    */\n    const updateLocation = async () => {\n        await Location.getCurrentPositionAsync({accuracy: Accuracy.Balanced}).then((item)=>{\n            setCurrentLocation(item.coords)\n        } );\n    };\n    /*\n    * Metoden handleLongPress tager en event med som argument og henter værdien af et koordinatsæt fra denne\n    * Værdien gemmes i en variabel, der tilføjes til et array af koordinater.\n    */\n    const handleLongPress = event => {\n        const coordinate = event.nativeEvent.coordinate\n        setUserMarkerCoordinates((oldArray) => [...oldArray, coordinate])\n    };\n\n    /*\n  * Metoden handleSelectMarker tager en koordinat med som argument. Kordinaten bruges\n  * til at sætte værdien af selectedCoordinat-variablen\n  * Dernæst aktiveres et asynkront kald, i form af den prædefinerede metode, reverseGeocodeAsync.\n  * reverseGeocodeAsync omsætter koordinatsættet til en række data, herunder område- og adresse data.\n  * selectedAdress sættes til at være resultatet af det asynkrone kald\n    */\n    const handleSelectMarker = async coordinate =>{\n        setSelectedCoordinate(coordinate)\n        await Location.reverseGeocodeAsync(coordinate).then((data) => {\n                setSelectedAddress(data)\n            }\n        )\n    };\n\n\n    //Metoden closeInfoBox nulstiller værdienne fro selectedAddress og selectedCoordinate\n    const closeInfoBox = () =>\n        setSelectedCoordinate(null) && setSelectedAddress(null)\n\n    // RenderCurrentLocation tager props med som argument og tjekker om, der er givet adgang til enhedens lokationsdata\n    // Er der ikke givet adgang returneres der en tekstkomponent med instruktioner til brugeren\n    //Er der givet tilladelse og currenLocation ikke har en værdi, vil der fremvises en knap komponent\n    //Er der givet tilladelse go currentlokation har en værdi, vil lokationsdata blive udskrvet i en infoboks\n    const RenderCurrentLocation = (props) => {\n        if (props.hasLocationPermission === null) {\n            return null;\n        }\n        if (props.hasLocationPermission === false) {\n            return <Text>No location access. Go to settings to change</Text>;\n        }\n        return (\n            <View>\n                <Button style title=\"update location\" onPress={updateLocation} />\n                {currentLocation1 && (\n                    <Text>\n                        {`lat: ${currentLocation1.latitude},\\nLong:${\n                            currentLocation1.longitude\n                        }\\nacc: ${currentLocation1.accuracy}`}\n                    </Text>\n                )}\n            </View>\n        );\n    };\n\n\n\n\n    //Hvis der af en eller anden grund ikke skulle være muligt at fremfinde den aktive bruger,\n    //skal der udprintes en besked om dette igennem en tekstkomponent\n    if (!firebase.auth().currentUser) {\n        return (\n            <ScrollView>\n                <Image\n                    source={require('../assets/dk-madkort.jpeg')}\n                    style={styles.image}/>\n\n                <Card style={{padding:20}}>\n                    <SignUpForm />\n                </Card>\n\n                <Card style={{padding:20}}>\n                    <LoginForm />\n                </Card>\n                <Text style={styles.paragraph2}>\n                    Jeg håber virkelig dette kan hjælpe bare en smule!\n                </Text>\n            </ScrollView>\n        )\n    }else\n        /*\n  * Dernæst kaldes RenderCurrenokation view\n  * Mapview er fremviser et kort, der viser brugerens lokation\n  * Dernæst aktiverer metoden handleLongPress igennem onLongPress\n  * I Mapview vises tre markører ud fra vilkårlige koordinatsæt. Hver markør får en titel og en beskrivelse\n  * Derudover vil alle koordinatsæt i userMarkerCoordinates blive vist som markører på kortet.\n  * For hver af markørerne vil metoden handleSelectMarker blive aktiveret ved onPress,\n  * hvorved selectedCoordinate og selectedAddres får en værdi og der udskrives data om den vaælgte markør\n  *\n  */\n    {\n        return (\n            <View style= {styles.container}>\n                {\n                    // https://www.npmjs.com/package/react-native-google-places-autocomplete\n                    // Video: https://www.youtube.com/watch?v=qlELLikT3FU&ab_channel=DarwinTech\n                }\n                <GooglePlacesAutocomplete\n                    placeholder='Search'\n                    miniLenght={2}\n                    autoFocus={false}\n                    fetchDetails={true}\n                    renderDescription={row=>row.description}\n\n                    onPress={(data, details = null) => {\n                        // 'details' is provided when fetchDetails = true\n                        console.log(data, details);\n                        //TODO Herunder kan man tilføje logik, når der trykkes på det søgte\n\n                    }}\n                    getDefaultValue={()=>''}\n                    query={{\n                        // Husk at krypter API key, fordi ellers er den tilgængelig for alle!\n                        key: 'AIzaSyCc8mR9JJqFV35qcL7WXn8nBvFPNGZ101w',\n                        language: 'en', // Resultatets sprog\n                        types: \"establishment\",\n                        components: \"country:dk\",\n                        // Forsøger at sætte søgning til at søge inden for en radius af 20km af KBH (Virker ikke)\n                        radius: 20000,\n                        location: {\n                            latitude: 55.676098,\n                            longitude: 12.568337,\n                        },\n                    }}\n                    styles={{\n                        container: { flex: 0, position: \"absolute\", width: \"100%\", zIndex: 1},\n                        listView: {backgroundColor: \"grey\"},\n                    }}\n                    currentLocation={true}\n                    currentLocationLabel='Current Location'\n                    nearbyPlacesAPI='GooglePlacesSearch'\n                    GoogleReverseGeocodingQuery={{\n                        // ved ikke helt hvad man bruger dette til\n                    }}\n                    GooglePlacesSearchQuery={{\n                        rankby: 'distance',\n                        type: 'restaurant'\n                    }}\n                    GooglePlacesDetailsQuery={{\n                        fields: 'formatted_address'\n                    }}\n                    debounce={200} // devouncer req i ms. Sat til 0 for at fjerne debounce\n\n                />\n\n                {\n                    <RenderCurrentLocation props={{hasLocationPermission: hasLocationPermission, currentLocation1: currentLocation1}} />\n                }\n                <MapView\n                    provider={'google'}\n                    initialRegion={{\n                        latitude: 55.676098,\n                        longitude: 12.568337,\n                        latitudeDelta: 0.0922,\n                        longitudeDelta: 0.0421,\n                    }}\n                    style={styles.map}\n                    //style={styles.map}\n\n\n                    showsUserLocation\n                    onLongPress={handleLongPress}\n\n\n                    >\n\n                    <Marker\n                        coordinate={{ latitude: 55.676195, longitude: 12.569419 }}\n                        title=\"Rådhuspladsen\"\n                        description=\"blablabal\"\n                    />\n                    <Marker\n                        coordinate={{ latitude: 55.673035, longitude: 12.568756 }}\n                        title=\"Tivoli\"\n                        description=\"blablabal\"\n                    />\n                    <Marker\n                        coordinate={{ latitude: 55.674082, longitude: 12.598108 }}\n                        title=\"Christiania\"\n                        description=\"blablabal\"\n                    >\n                    </Marker>\n\n                    {userMarkerCoordinates.map((coordinate, index) => (\n                        <Marker\n                            coordinate={coordinate}\n                            key={index.toString()}\n                            onPress={() => handleSelectMarker(coordinate)}\n                        />\n                    ))}\n\n\n\n                </MapView>\n\n                {selectedCoordinate && selectedAddress && (\n                    <View style={styles.infoBox}>\n                        <Text style={styles.infoText}>\n                            {selectedCoordinate.latitude}, {selectedCoordinate.longitude}\n                        </Text>\n                        <Text style={styles.infoText}>\n                            name: {selectedAddress[0].name}  region: {selectedAddress[0].region}\n                        </Text>\n                        <Button title=\"close\" onPress={closeInfoBox} />\n                    </View>\n                )}\n\n            </View>\n        );\n    }\n}\n\n//Lokal styling til brug i Map\nconst styles = StyleSheet.create({\n    container: {\n        flex: 1,\n        //justifyContent: 'center',\n        //paddingTop: Constants.statusBarHeight,\n        //backgroundColor: '#ecf0f1',\n        //padding: 8,\n    },\n    map: {\n        width: Dimensions.get(\"window\").width,\n        height: Dimensions.get(\"window\").height,\n    },\n    infoBox: {\n        height: 200,\n        position: 'absolute',\n        bottom: 0,\n        left: 0,\n        right: 0,\n        backgroundColor: 'yellow',\n        justifyContent: 'center',\n        alignItems: 'center',\n    },\n    infoText: {\n        fontSize: 15,\n    },\n    image: {\n        marginHorizontal: \"10%\",\n        marginTop: \"5%\",\n        marginBottom: \"5%\",\n        width: \"80%\",\n        height: \"25%\",\n    },\n    paragraph2: {\n        marginTop: '50%',\n        fontSize: 18,\n        fontWeight: 'bold',\n        textAlign: 'center',\n    }\n});\n\n//Eksport af Loginform, således denne kan importeres og benyttes i andre komponenter\nexport default Map;\n"]},"metadata":{},"sourceType":"module"}